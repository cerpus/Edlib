id: 55300
name: edlib-cerpus-hub
environments:
    staging:
        memory: 128
        cli-memory: 128
        runtime: docker
        domain: hub.edlibdev.net
        network: edlib-cerpus-test
        database: hub-v2
        cache: edlib-cerpus-test-cache
        queues: edlib-cerpus-test
        storage: edlib-cerpus-test-hub
        build:
            - 'COMPOSER_MIRROR_PATH_REPOS=1 composer install --no-interaction --prefer-dist --no-dev --optimize-autoloader'
            - 'php artisan optimize'
            - 'php artisan event:cache'
            - 'npm ci && npm run build && rm -rf node_modules'
        deploy:
            - 'php artisan migrate --force'
            - "php artisan scout:index 'App\\Models\\Content'"
            - 'php artisan scout:sync-index-settings'
